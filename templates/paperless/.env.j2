# ansible/templates/paperless/.env.j2

# Database
POSTGRES_PASSWORD={{ ansible_date_time.epoch }}{{ user.name }}{{ 999999 | random }}

# Paperless-ngx settings
PAPERLESS_SECRET_KEY={{ lookup('password', '/dev/null chars=ascii_letters,digits length=' + (paperless.secret_key_length | string)) }}
PAPERLESS_ALLOWED_HOSTS={{ paperless.allowed_hosts }}
PAPERLESS_CORS_ALLOWED_HOSTS={{ paperless.cors_allowed_hosts }}
PAPERLESS_TIME_ZONE={{ paperless.time_zone }}
PAPERLESS_OCR_LANGUAGE={{ paperless.ocr_language }}

# User-specific settings
PAPERLESS_ADMIN_USER={{ user.name }}
PAPERLESS_ADMIN_MAIL={{ user.email }}
PAPERLESS_ADMIN_PASSWORD={{ lookup('password', '/dev/null chars=ascii_letters,digits length=16') }}

# Media and data paths (container paths)
PAPERLESS_MEDIA_ROOT=/usr/src/paperless/media
PAPERLESS_DATA_DIR=/usr/src/paperless/data
PAPERLESS_CONSUMPTION_DIR=/usr/src/paperless/consume
PAPERLESS_EXPORT_DIR=/usr/src/paperless/export

# Consumer settings
PAPERLESS_CONSUMER_POLLING=0
PAPERLESS_CONSUMER_DELETE_DUPLICATES=true
PAPERLESS_CONSUMER_RECURSIVE=true
PAPERLESS_CONSUMER_SUBDIRS_AS_TAGS=true

# Feature toggles
PAPERLESS_TASK_WORKERS=1
PAPERLESS_THREADS_PER_WORKER=1